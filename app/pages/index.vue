<template>
  <div class="apple-wrapper">
    <nav class="navbar">
      <div class="nav-content">
        <a href="/" class="nav-logo">Dana Kim</a>
        <div class="nav-links">
          <a href="#philosophy">Philosophy</a>
          <a href="#experience">Experience</a>
          <a href="#skills">Tech Specs</a>
          <a href="#logs">Dev Logs</a>
        </div>
      </div>
    </nav>

    <main class="main-content">
      <section class="section hero">
        <div class="hero-content animate-on-scroll">
          <h2 class="eyebrow">Data Analytics Engineer</h2>
          <h1 class="hero-title">
            Dana Kim.<br />
            <span class="gradient-text">Data meets Impact.</span>
          </h1>
          <p class="hero-subtitle">ì˜ˆì˜ê²Œ ì •ë¦¬ëœ ë°ì´í„°ê°€ ì•„ë‹Œ, ì‹¤ì œ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ì‹œìŠ¤í…œì„ ë§Œë“­ë‹ˆë‹¤.</p>
          
          <div class="social-links">
            <a href="mailto:ë³¸ì¸ë©”ì¼@gmail.com" target="_blank" class="social-btn">Gmail</a>
            <a href="https://www.linkedin.com/in/ë³¸ì¸ë§í¬ë“œì¸ì£¼ì†Œ" target="_blank" class="social-btn">LinkedIn</a>
            <a href="https://github.com/danakkii" target="_blank" class="social-btn">GitHub</a>
          </div>
        </div>
      </section>

      <section id="philosophy" class="section philosophy">
        <div class="text-container animate-on-scroll">
          <h2 class="section-heading">Architecting Data for<br/>Operational Excellence.</h2>
          <p class="section-desc">
            As a Data Analytics Engineer, I focus on the entire data lifecycleâ€”from ingestion and processing to downstream utilization. Rather than merely building isolated data silos, I architect scalable pipelines that translate raw data into actionable intelligence.<br/><br/>
            By closely aligning data models with the operational realities of cross-functional teams, such as CS, Operations, and Marketing, I ensure high data availability and reliability. My ultimate goal is to operationalize data assets so they serve as a robust foundation for strategic decision-making and continuous business optimization.
          </p>
        </div>
      </section>

      <section id="experience" class="section experience-section">
        <div class="experience-container">
          <h2 class="section-title animate-on-scroll">Experience.</h2>
          <div class="timeline">
            <div class="timeline-card animate-on-scroll">
              <div class="card-header">
                <h3>Data Analytics Engineer</h3>
                <span class="company">Teamremited (íŒ€ë¦¬ë¯¸í‹°ë“œ)</span>
                <span class="period">2025.09 â€“ Present</span>
              </div>
              <ul class="achievements">
                <li>ì „ì‚¬ ìµœì´ˆ ì˜ìˆ˜ì¦ ë¶„ì„ìš© ë°ì´í„°ë§ˆíŠ¸ êµ¬ì¶• (2,000ë§Œ ê±´, Airflow ê¸°ë°˜)</li>
                <li>ë²¡í„° DB(Qdrant) í™œìš© 30ë§Œ ê±´ ìƒì ëª… ì •ê·œí™” ë° ì§€ë„ ì‹œê°í™”</li>
                <li>CS ë¬¸ì˜ íŒ¨í„´ ë¶„ì„ ë° LLM RAG ì±—ë´‡ ë„ì…ìœ¼ë¡œ ì¼ í‰ê·  CS 30% ì ˆê°</li>
                <li>FastAPI ê¸°ë°˜ ì‹¤ì‹œê°„ API ë° Redis ê¸°ë°˜ ì¼ 10ë§Œ ì¥ ì¤‘ë³µ ê²€ì¦ ì‹œìŠ¤í…œ êµ¬ì¶•</li>
              </ul>
            </div>

            <div class="timeline-card animate-on-scroll">
              <div class="card-header">
                <h3>Back-end Developer</h3>
                <span class="company">Teamremited (íŒ€ë¦¬ë¯¸í‹°ë“œ)</span>
                <span class="period">2024.12 â€“ 2025.09</span>
              </div>
              <ul class="achievements">
                <li>ì†Œì…œ ë¡œê·¸ì¸ í”Œë¡œìš° ì¬ì„¤ê³„ë¡œ ë°ì´í„° ì •í•©ì„± ë³´ì¥ ë° ê°€ì… ì „í™˜ìœ¨ 1.5ë°° í–¥ìƒ</li>
                <li>í™ˆ í™”ë©´ ë³‘ëª© ì¿¼ë¦¬ ìµœì í™”ë¡œ ì ‘ê·¼ ì‹œê°„ 5ì´ˆ ì´ìƒ ë‹¨ì¶•</li>
                <li>AI ì½”ë“œ ë¦¬ë·° ìë™í™” ì ìš©ìœ¼ë¡œ ë¦¬ë·° ì†ë„ 30% í–¥ìƒ</li>
              </ul>
            </div>

            <div class="timeline-card animate-on-scroll">
              <div class="card-header">
                <h3>AI Application Engineer</h3>
                <span class="company">Elroilab (ì—˜ë¡œì´ë©)</span>
                <span class="period">2023.06 â€“ 2024.12</span>
              </div>
              <ul class="achievements">
                <li>Gaussian Noise ê¸°ë²• í™œìš© DDCNN ëª¨ë¸ ìµœì í™”ë¡œ ì´ìƒì¹˜ íƒì§€ ì„±ëŠ¥ 35% í–¥ìƒ</li>
                <li>AI ëª¨ë¸ í•™ìŠµìš© ë¼ë²¨ë§ ì‘ì—… ìë™í™” ì‹œìŠ¤í…œ ê°œë°œ</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <section id="skills" class="section skills-section">
        <div class="skills-container">
          <h2 class="section-title animate-on-scroll">Tech Specs.</h2>
          <div class="grid-cards">
            <div class="spec-card dark-card animate-on-scroll">
              <h3>Data & Pipeline</h3>
              <p>BigQuery, Airflow, Redis<br/>MongoDB, PostgreSQL</p>
              <span class="card-note">íë¦„ì„ ì œì–´í•˜ëŠ” ê²¬ê³ í•¨.</span>
            </div>
            <div class="spec-card light-card animate-on-scroll">
              <h3>Backend & AI</h3>
              <p>Python, FastAPI, Node.js<br/>PyTorch, Qdrant</p>
              <span class="card-note">ì‹¤ì œ ë¬¸ì œë¥¼ í‘¸ëŠ” ë¡œì§.</span>
            </div>
            <div class="spec-card dark-card animate-on-scroll">
              <h3>Infra & Analytics</h3>
              <p>Docker, Kubernetes<br/>Grafana, Metabase</p>
              <span class="card-note">ì‹œê°í™”ì™€ í™•ì¥ì˜ ì™„ì„±.</span>
            </div>
          </div>
        </div>
      </section>

      <section id="logs" class="section blog-section">
        <div class="blog-container">
          <h2 class="section-title dark-text animate-on-scroll">Latest Logs.</h2>
          
          <div v-if="pending" class="loading">ë°ì´í„°ë¥¼ ë™ê¸°í™” ì¤‘ì…ë‹ˆë‹¤...</div>
          
          <div v-else class="post-grid">
            <div v-if="!posts || posts.length === 0" class="empty-state animate-on-scroll">
              ì•„ì§ ì‘ì„±ëœ ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.
            </div>
            
            <article v-for="post in posts" :key="post.id" class="post-card animate-on-scroll">
              <div class="post-header">
                <span class="post-date">{{ formatDate(post.created_at) }}</span>
              </div>
              <h3 class="post-title">{{ post.title }}</h3>
              <p class="post-content">{{ getPreviewText(post.content) }}</p>
              <NuxtLink :to="`/posts/${post.id}`" class="read-more">
                ë” ì•Œì•„ë³´ê¸° <span>&rsaquo;</span>
              </NuxtLink>
            </article>
          </div>
        </div>
      </section>

      <section class="section guestbook-section">
        <div class="guestbook-container animate-on-scroll">
          <h2 class="section-title">Guestbook.</h2>
          <p class="guestbook-desc">ë°©ë¬¸í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ììœ ë¡­ê²Œ ë°œìì·¨ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”!</p>
          <div ref="giscusContainer" class="giscus-wrapper"></div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <p>Copyright Â© {{ new Date().getFullYear() }} Dana Kim. All rights reserved.</p>
    </footer>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'

const supabase = useSupabaseClient()

const { data: posts, pending } = await useAsyncData('posts', async () => {
  const { data } = await supabase
    .from('post')
    .select('id, created_at, title, content')
    .order('created_at', { ascending: false })
  return data
})

const formatDate = (dateString) => {
  if (!dateString) return ''
  const date = new Date(dateString)
  return `${date.getFullYear()}. ${String(date.getMonth() + 1).padStart(2, '0')}. ${String(date.getDate()).padStart(2, '0')}.`
}

// ë§ˆí¬ë‹¤ìš´ íŠ¹ìˆ˜ë¬¸ì(#, *, -, ì´ë¯¸ì§€ ë“±)ë¥¼ ì œê±°í•˜ê³  ìˆœìˆ˜ í…ìŠ¤íŠ¸ë§Œ ë½‘ì•„ë‚´ëŠ” í•¨ìˆ˜
const getPreviewText = (text) => {
  if (!text) return ''
  return text
    .replace(/#+\s/g, '') // í—¤ë” ì œê±°
    .replace(/(\*\*|__)(.*?)\1/g, '$2') // ë³¼ë“œ ì œê±°
    .replace(/(\*|_)(.*?)\1/g, '$2') // ì´íƒ¤ë¦­ ì œê±°
    .replace(/!\[.*?\]\(.*?\)/g, '') // ì´ë¯¸ì§€ ë§í¬ ì œê±°
    .replace(/\[([^\]]+)\]\([^\)]+\)/g, '$1') // ì¼ë°˜ ë§í¬ ì œê±°
    .replace(/`{1,3}[^`\n]*`{1,3}/g, '') // ì¸ë¼ì¸ ì½”ë“œ ë° ì½”ë“œ ë¸”ë¡ ì œê±°
    .replace(/\n/g, ' ') // ì¤„ë°”ê¿ˆì„ ê³µë°±ìœ¼ë¡œ ë³€ê²½
    .trim()
}

const giscusContainer = ref(null)

onMounted(() => {
  // Giscus ì…‹ì—…
  if (giscusContainer.value) {
    const script = document.createElement('script')
    script.src = 'https://giscus.app/client.js'
    script.setAttribute('data-repo', 'danakkii/dev-blog')
    script.setAttribute('data-repo-id', 'R_kgDORV26yw')
    script.setAttribute('data-category', 'General')
    script.setAttribute('data-category-id', 'DIC_kwDORV26y84C29dY')
    script.setAttribute('data-mapping', 'pathname')
    script.setAttribute('data-strict', '0')
    script.setAttribute('data-reactions-enabled', '1')
    script.setAttribute('data-emit-metadata', '0')
    script.setAttribute('data-input-position', 'bottom')
    script.setAttribute('data-theme', 'dark')
    script.setAttribute('data-lang', 'ko')
    script.crossOrigin = 'anonymous'
    script.async = true
    
    giscusContainer.value.appendChild(script)
  }

  // ì• í”Œ ìŠ¤íƒ€ì¼ ìŠ¤í¬ë¡¤ ì• ë‹ˆë©”ì´ì…˜ (Intersection Observer)
  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible')
      }
    })
  }, { threshold: 0.15 }) // ìš”ì†Œê°€ 15% ë³´ì¼ ë•Œ ì‘ë™

  // animate-on-scroll í´ë˜ìŠ¤ë¥¼ ê°€ì§„ ëª¨ë“  ìš”ì†Œ ê´€ì°° ì‹œì‘
  document.querySelectorAll('.animate-on-scroll').forEach((el) => {
    observer.observe(el)
  })
})
</script>

<style scoped>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Noto+Sans+KR:wght@400;600;700;900&display=swap');

.apple-wrapper { font-family: 'Inter', 'Noto Sans KR', sans-serif; background-color: #000; color: #f5f5f7; overflow-x: hidden; }
*, *::before, *::after { box-sizing: inherit; }

/* ğŸŒŸ ìŠ¤í¬ë¡¤ ì• ë‹ˆë©”ì´ì…˜ ê¸°ë³¸ ìƒíƒœ (íˆ¬ëª…í•˜ê³  ì•„ë˜ë¡œ ì‚´ì§ ë‚´ë ¤ê°€ ìˆìŒ) */
.animate-on-scroll {
  opacity: 0;
  transform: translateY(40px);
  transition: opacity 0.8s cubic-bezier(0.25, 1, 0.5, 1), transform 0.8s cubic-bezier(0.25, 1, 0.5, 1);
}

/* ğŸŒŸ ìŠ¤í¬ë¡¤í•´ì„œ ë³´ì´ë©´ ì ìš©ë˜ëŠ” ìƒíƒœ (ì„ ëª…í•´ì§€ê³  ì œìë¦¬ë¡œ ì˜¬ë¼ì˜´) */
.animate-on-scroll.visible {
  opacity: 1;
  transform: translateY(0);
}

/* Navbar */
.navbar { position: fixed; top: 0; width: 100%; background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(20px); z-index: 1000; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
.nav-content { max-width: 1000px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; padding: 15px 24px; }
.nav-logo { color: #f5f5f7; text-decoration: none; font-weight: 700; font-size: 1.1rem; }
.nav-links { display: flex; gap: 24px; }
.nav-links a { color: #c8c8cc; text-decoration: none; font-size: 0.9rem; font-weight: 500; transition: 0.3s; }
.nav-links a:hover { color: #fff; }

.section { display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 100vh; padding: 80px 24px; text-align: center; }
.section-title { font-size: 3.5rem; font-weight: 800; letter-spacing: -0.04em; margin-bottom: 60px; }

/* Hero */
.hero { background: radial-gradient(circle at center, #1a1a1a 0%, #000000 70%); margin-top: 40px; }
.eyebrow { color: #f56900; font-size: 1.2rem; font-weight: 700; letter-spacing: 0.1em; margin-bottom: 20px; }
.hero-title { font-size: 5.5rem; font-weight: 800; line-height: 1.1; letter-spacing: -0.04em; margin: 0 0 30px 0; }
.gradient-text { background: linear-gradient(90deg, #ff2a85, #8a2387, #e94057); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.hero-subtitle { font-size: 1.3rem; color: #86868b; font-weight: 600; word-break: keep-all; margin-bottom: 40px; }

/* Social Links */
.social-links { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 20px;}
.social-btn { 
  display: inline-block; padding: 10px 24px; border-radius: 30px; 
  background: rgba(255,255,255,0.1); color: #fff; text-decoration: none; 
  font-weight: 600; font-size: 0.95rem; transition: all 0.3s ease;
  border: 1px solid rgba(255,255,255,0.2);
}
.social-btn:hover { background: #fff; color: #000; transform: translateY(-2px); }

/* Philosophy */
.philosophy { background-color: #000; min-height: 60vh; }
.text-container { max-width: 800px; }
.section-heading { font-size: 4rem; font-weight: 800; line-height: 1.2; letter-spacing: -0.04em; margin-bottom: 30px; }
.section-desc { font-size: 1.2rem; color: #a1a1a6; line-height: 1.6; font-weight: 500; word-break: keep-all; }

/* Experience */
.experience-section { background-color: #0a0a0c; }
.experience-container { max-width: 900px; width: 100%; text-align: left; }
.timeline-card { background: #1c1c1e; border-radius: 24px; padding: 40px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
.card-header h3 { font-size: 1.8rem; margin: 0 0 10px 0; color: #fff; }
.company { font-size: 1.1rem; color: #ff2a85; font-weight: 600; margin-right: 15px; }
.period { color: #86868b; font-size: 0.95rem; }
.achievements { margin-top: 20px; padding-left: 20px; color: #c8c8cc; line-height: 1.6; }
.achievements li { margin-bottom: 8px; }

/* Skills */
.skills-section { background-color: #111; min-height: 80vh; }
.skills-container { max-width: 1000px; width: 100%; }
.grid-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
.spec-card { border-radius: 24px; padding: 40px; text-align: left; display: flex; flex-direction: column; min-height: 250px; }
.dark-card { background: #1c1c1e; color: #f5f5f7; }
.light-card { background: #f5f5f7; color: #1d1d1f; }
.spec-card h3 { font-size: 1.5rem; font-weight: 800; margin: 0 0 15px 0; }
.spec-card p { font-size: 1.1rem; margin: 0; opacity: 0.8; line-height: 1.5; }
.card-note { font-size: 0.9rem; font-weight: 600; margin-top: auto; color: #86868b; }

/* Logs */
.blog-section { background-color: #f5f5f7; color: #1d1d1f; }
.blog-container { max-width: 1000px; width: 100%; text-align: left; }
.dark-text { color: #1d1d1f; text-align: center; }
.post-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
.post-card { background: #fff; border-radius: 24px; padding: 40px; display: flex; flex-direction: column; transition: transform 0.3s, box-shadow 0.3s; }
.post-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); }
.post-date { font-size: 0.9rem; font-weight: 700; color: #86868b; margin-bottom: 15px; display: block; }
.post-title { font-size: 1.5rem; font-weight: 800; margin: 0 0 15px 0; letter-spacing: -0.03em; }

/* ğŸŒŸ í¬ìŠ¤íŠ¸ 1ì¤„ ë¯¸ë¦¬ë³´ê¸° ê°•ì œ ì ìš© */
.post-content { 
  color: #515154; 
  font-size: 1.05rem;
  line-height: 1.6; 
  margin-bottom: 30px; 
  white-space: nowrap; 
  overflow: hidden; 
  text-overflow: ellipsis; 
}

.read-more { text-decoration: none; color: #0066cc; font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; }
.read-more span { font-size: 1.5rem; margin-left: 5px; transition: 0.2s; }
.read-more:hover span { margin-left: 10px; }

/* Guestbook */
.guestbook-section { background-color: #000; min-height: 60vh; }
.guestbook-container { max-width: 800px; width: 100%; }
.guestbook-desc { color: #86868b; margin-bottom: 40px; font-size: 1.1rem; }
.giscus-wrapper { width: 100%; }

.footer { text-align: center; padding: 40px 0; background: #000; color: #86868b; border-top: 1px solid #222; }

/* Mobile */
@media (max-width: 768px) {
  .nav-content { padding: 12px 15px; }
  .nav-links { display: none; }
  .hero-title { font-size: 3.5rem; }
  .section-heading { font-size: 2.5rem; }
  .section-desc { font-size: 1.1rem; }
  .section-title { font-size: 2.5rem; }
  .timeline-card, .spec-card, .post-card { padding: 25px; }
}
</style>